{"version":3,"sources":["webpack:///./src/views/main/protected/Slideshow.vue?4d2f","webpack:///./src/views/main/protected/Slideshow.vue","webpack:///./src/views/main/protected/Slideshow.vue?a245"],"names":["class","_createElementBlock","_Fragment","_renderList","$data","i","id","key","_createVNode","_Transition","name","photo","src","filename","style","maxHeight","maxWidth","marginTop","marginLeft","data","photos","displayedPhotos","photoGrids","methods","connectWebSocket","that","this","socket","WebSocket","wsUrl","onmessage","e","JSON","parse","action","unshift","$store","commit","content","color","filter","p","console","log","onclose","showTime","setTimeout","onerror","err","message","close","replacePhoto","oldPhoto","random","Math","floor","length","randomPhoto","includes","replaceIn","push","splice","indexOf","mounted","Api","getAllPhotos","state","token","then","resp","finally","forEach","beforeUnmount","__exports__","render"],"mappings":"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","file":"js/protected/Slideshow.a38f5f8a.js","sourcesContent":["export * from \"-!../../../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--9-oneOf-1-0!../../../../node_modules/css-loader/dist/cjs.js??ref--9-oneOf-1-1!../../../../node_modules/vue-loader-v16/dist/stylePostLoader.js!../../../../node_modules/postcss-loader/src/index.js??ref--9-oneOf-1-2!../../../../node_modules/sass-loader/dist/cjs.js??ref--9-oneOf-1-3!../../../../node_modules/cache-loader/dist/cjs.js??ref--1-0!../../../../node_modules/vue-loader-v16/dist/index.js??ref--1-1!./Slideshow.vue?vue&type=style&index=0&id=6341b7e8&lang=scss\"","<template>\n  <div class=\"outer-wrap\">\n    <div v-for=\"i in photoGrids\"\n         class=\"griditem\"\n         :class=\"`girditem${i.id}`\"\n         :key=\"i.id\">\n         <transition name=\"fade\">\n           <img v-if=\"i.photo\"\n                :src=\"`/uploaded/${i.photo.filename}`\"\n                :key=\"i.photo.filename\"\n                :style=\"{maxHeight: i.photo.maxHeight + '%',\n                         maxWidth: i.photo.maxWidth + '%',\n                         marginTop: i.photo.marginTop + 'px',\n                         marginLeft: i.photo.marginLeft + 'px'}\">\n         </transition>\n    </div>\n  </div>\n</template>\n\n<script>\nimport {Api} from \"@/api/api.js\";\nimport {wsUrl} from '@/env'\n\nexport default {\n  name: 'Home',\n  data() {\n    return {\n      photos: [],\n      displayedPhotos: [],\n      photoGrids: [{id: 1, photo: null}, {id: 2, photo: null}, {id: 3, photo: null}, {id: 4, photo: null}, {id: 5, photo: null},{id: 6, photo: null},{id: 7, photo: null},{id: 8, photo: null}]\n    }\n  },\n  methods: {\n    connectWebSocket() {\n      let that = this\n      that.socket = new WebSocket(`${wsUrl}/new_photos`)\n      that.socket.onmessage = function(e) {\n        let data = JSON.parse(e.data)\n        if (data.action === 'add') {\n          that.photos.unshift(data.photo)\n          that.$store.commit('addNotification', { content: 'Neues Foto', color: 'success' })\n        } else if (data.action === 'delete') {\n          that.photos = that.photos.filter((p) => p.filename != data.photo.filename)\n          that.$store.commit('addNotification', { content: 'Ein Foto wurde entfernt.', color: 'success' })\n        } else {\n          console.log('Websocket received unknown action \"' + data.action + '\".');\n        }\n      }\n      that.socket.onclose = function() {\n        that.$store.commit('addNotification', { content: 'Verbindung zum Server verloren.', color: 'error', showTime: 2000 })\n        console.log('WebSocket connection is closed. Attem,pting reconnect.');\n        setTimeout(function() {that.connectWebSocket()}, 1000)\n      }\n      that.socket.onerror = function(err) {\n        console.log('WebSocket encountered error: ' + err.message + 'Closing Websocket.');\n        that.socket.close()\n      }\n    },\n    replacePhoto(p) {\n      let oldPhoto = p.photo\n      let random = Math.floor(Math.random() * this.photos.length);\n      let randomPhoto = this.photos[random]\n      if (!(this.displayedPhotos.includes(randomPhoto.filename)) && !(randomPhoto === oldPhoto)) {\n        //random Margins in range -100 to 100\n        randomPhoto.marginTop = Math.floor(Math.random()*200-100)\n        randomPhoto.marginLeft = Math.floor(Math.random()*200-100)\n        // ranom MaxDimensions in range 100 to 120\n        randomPhoto.maxWidth = Math.floor(Math.random()* (120 - 100 +1) + 100)\n        randomPhoto.maxHeight = Math.floor(Math.random()* (120 - 100 +1) + 100)\n\n        p.photo = randomPhoto\n        this.displayedPhotos.push(randomPhoto.filename)\n        if (oldPhoto) {\n          this.displayedPhotos.splice(this.displayedPhotos.indexOf(oldPhoto.filename), 1)\n        }\n        var replaceIn = Math.floor(Math.random() * (20 - 10 + 1) + 10)\n      } else {\n        replaceIn = 1\n      }\n      // console.log(replaceIn);\n      let that = this;\n      setTimeout(function () {\n        that.replacePhoto(p)\n      }, replaceIn*1000);\n\n    }\n  },\n  mounted() {\n    Api.getAllPhotos(this.$store.state.token)\n      .then(resp => {\n        this.photos = resp.data\n      })\n      .then(() => {\n        this.connectWebSocket()\n      })\n      .finally(() => {\n        this.photoGrids.forEach((p) => {\n          this.replacePhoto(p)\n        });\n\n      })\n  },\n  beforeUnmount() {\n    this.socket.close()\n  }\n\n}\n</script>\n\n<style lang=\"scss\">\n  #header {\n    display: none;\n  }\n  .outer-wrap {\n    position: fixed;\n    top: 0;\n    left: 0;\n    width: 100vw;\n    height: 100vh;\n    background-color: black;\n    display: grid;\n    grid-template-columns: repeat(4, 1fr);\n    grid-template-rows: repeat(12, 1fr);\n  }\n\n  .griditem {\n    display: grid;\n    justify-items: center;\n    align-items: center;\n    position: relative;\n    & img {\n      position: absolute;\n      top: 0;\n      max-width: 100%;\n      max-height: 100%;\n    }\n  }\n\n  .girditem1 {\n    grid-column-start: 0;\n    grid-column-end: 2;\n    grid-row-start:1;\n    grid-row-end:5;\n    // background-color: red;\n  }\n\n  .girditem2 {\n    grid-column-start: 0;\n    grid-column-end: 2;\n    grid-row-start:5;\n    grid-row-end:9;\n    // background-color: blue;\n  }\n\n  .girditem3 {\n    grid-column-start: 0;\n    grid-column-end: 2;\n    grid-row-start:9;\n    grid-row-end:13;\n    // background-color: green;\n  }\n\n  .girditem4 {\n    grid-column-start: 2;\n    grid-column-end: 3;\n    grid-row-start:1;\n    grid-row-end:7;\n    // background-color: green;\n  }\n\n  .girditem5 {\n    grid-column-start: 3;\n    grid-column-end: 4;\n    grid-row-start:1;\n    grid-row-end:7;\n    // background-color: blue;\n  }\n\n  .girditem6 {\n    grid-column-start: 2;\n    grid-column-end: 4;\n    grid-row-start:7;\n    grid-row-end:13;\n    // background-color: red;\n  }\n\n  .girditem7 {\n    grid-column-start: 4;\n    grid-column-end: 5;\n    grid-row-start:1;\n    grid-row-end:8;\n    // background-color: green;\n  }\n\n  .girditem8 {\n    grid-column-start: 4;\n    grid-column-end: 5;\n    grid-row-start:8;\n    grid-row-end:13;\n    // background-color: blue;\n  }\n\n  .fade-enter-active,\n  .fade-leave-active {\n    transition: opacity 3s ease-in-out;\n  }\n\n  .fade-enter-from,\n  .fade-leave-to {\n    opacity: 0;\n  }\n</style>\n","import { render } from \"./Slideshow.vue?vue&type=template&id=6341b7e8\"\nimport script from \"./Slideshow.vue?vue&type=script&lang=js\"\nexport * from \"./Slideshow.vue?vue&type=script&lang=js\"\n\nimport \"./Slideshow.vue?vue&type=style&index=0&id=6341b7e8&lang=scss\"\n\nimport exportComponent from \"/home/elpunkt/Documents/PhotoCanvas/frontend/node_modules/vue-loader-v16/dist/exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['render',render]])\n\nexport default __exports__"],"sourceRoot":""}