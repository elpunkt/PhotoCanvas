(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["protected/Slideshow"],{"0bc5":function(o,t,e){},"80cf":function(o,t,e){"use strict";e("0bc5")},a0f0:function(o,t,e){"use strict";e.r(t);var n=e("7a23");const i={class:"outer-wrap"},c=["src"];function s(o,t,e,s,a,h){return Object(n["u"])(),Object(n["g"])("div",i,[(Object(n["u"])(!0),Object(n["g"])(n["a"],null,Object(n["A"])(a.photoGrids,o=>(Object(n["u"])(),Object(n["g"])("div",{class:Object(n["p"])(["griditem","girditem"+o.id]),key:o.id},[Object(n["j"])(n["b"],{name:"fade"},{default:Object(n["H"])(()=>[o.photo?(Object(n["u"])(),Object(n["g"])("img",{src:"/uploaded/"+o.photo.filename,key:o.photo.filename,style:Object(n["q"])({maxHeight:o.photo.maxHeight+"%",maxWidth:o.photo.maxWidth+"%",marginTop:o.photo.marginTop+"px",marginLeft:o.photo.marginLeft+"px"})},null,12,c)):Object(n["f"])("",!0)]),_:2},1024)],2))),128))])}e("caad");var a=e("4ec3"),h={name:"Home",data(){return{photos:[],displayedPhotos:[],photoGrids:[{id:1,photo:null},{id:2,photo:null},{id:3,photo:null},{id:4,photo:null},{id:5,photo:null},{id:6,photo:null},{id:7,photo:null},{id:8,photo:null}]}},methods:{connectWebSocket(){let o=this;o.socket=new WebSocket("ws://localhost:8000/new_photos"),o.socket.onmessage=function(t){let e=JSON.parse(t.data);"add"===e.action?(o.photos.unshift(e.photo),o.$store.commit("addNotification",{content:"Neues Foto",color:"success"})):"delete"===e.action?(o.photos=o.photos.filter(o=>o.filename!=e.photo.filename),o.$store.commit("addNotification",{content:"Ein Foto wurde entfernt.",color:"success"})):console.log('Websocket received unknown action "'+e.action+'".')},o.socket.onclose=function(){o.$store.commit("addNotification",{content:"Verbindung zum Server verloren.",color:"error",showTime:2e3}),console.log("WebSocket connection is closed. Attem,pting reconnect."),setTimeout((function(){o.connectWebSocket()}),1e3)},o.socket.onerror=function(t){console.log("WebSocket encountered error: "+t.message+"Closing Websocket."),o.socket.close()}},replacePhoto(o){let t=o.photo,e=Math.floor(Math.random()*this.photos.length),n=this.photos[e];if(this.displayedPhotos.includes(n.filename)||n===t)i=1;else{n.marginTop=Math.floor(200*Math.random()-100),n.marginLeft=Math.floor(200*Math.random()-100),n.maxWidth=Math.floor(21*Math.random()+100),n.maxHeight=Math.floor(21*Math.random()+100),o.photo=n,this.displayedPhotos.push(n.filename),t&&this.displayedPhotos.splice(this.displayedPhotos.indexOf(t.filename),1);var i=Math.floor(11*Math.random()+10)}let c=this;setTimeout((function(){c.replacePhoto(o)}),1e3*i)}},mounted(){a["a"].getAllPhotos(this.$store.state.token).then(o=>{this.photos=o.data}).then(()=>{this.connectWebSocket()}).finally(()=>{this.photoGrids.forEach(o=>{this.replacePhoto(o)})})},beforeUnmount(){this.socket.close()}},l=(e("80cf"),e("6b0d")),r=e.n(l);const d=r()(h,[["render",s]]);t["default"]=d}}]);
//# sourceMappingURL=Slideshow.88198725.js.map