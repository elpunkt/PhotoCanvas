(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["protected/Slideshow"],{3734:function(e,t,o){},a0f0:function(e,t,o){"use strict";o.r(t);var s=o("7a23");const n={class:"outer-wrap"},h=["src"],c={key:0,class:"newPhotoContainer"},i=["src"],a={class:"statsandcontrols"},d={key:0};function l(e,t,o,l,r,p){return Object(s["u"])(),Object(s["g"])(s["a"],null,[Object(s["h"])("div",n,[(Object(s["u"])(!0),Object(s["g"])(s["a"],null,Object(s["A"])(r.photoHtmlItems,e=>(Object(s["u"])(),Object(s["g"])("div",{class:"photoItemContainer",key:e.id},[e.photo?(Object(s["u"])(),Object(s["g"])("img",{class:Object(s["p"])(["photoItem",e.photo.class]),src:"/uploaded/"+e.photo.filename,key:e.photo.filename,style:Object(s["q"])({left:e.photo.left+"px",top:e.photo.top+"px",zIndex:e.photo.zIndex,transform:e.photo.transform})},null,14,h)):Object(s["f"])("",!0)]))),128))]),Object(s["j"])(s["b"],{name:"fade"},{default:Object(s["J"])(()=>[r.displayedNewPhoto?(Object(s["u"])(),Object(s["g"])("div",c,[Object(s["h"])("img",{src:"/uploaded/"+r.displayedNewPhoto.filename,style:Object(s["q"])({zIndex:r.zIndex+100})},null,12,i)])):Object(s["f"])("",!0)]),_:1}),Object(s["h"])("div",a,[Object(s["i"])(Object(s["E"])(r.displayedPhotos.length)+" ",1),Object(s["h"])("span",{style:{cursor:"pointer","font-size":"2em"},onClick:t[0]||(t[0]=(...e)=>p.addPhoto&&p.addPhoto(...e))},"ðŸŽ²"),Object(s["h"])("div",null,Object(s["E"])(r.photos.length)+" Fotos in der Sammlung",1),r.newPhotos.length>1?(Object(s["u"])(),Object(s["g"])("div",d,Object(s["E"])(r.newPhotos.length-1)+" Neue Fotos in der Warteschlange",1)):Object(s["f"])("",!0)])],64)}o("caad");var r=o("4ec3"),p=o("8c89"),m={name:"Home",data(){return{photos:[],displayedPhotos:[],newPhotos:[],displayedNewPhoto:null,readyForNewPhoto:!0,photoHtmlItems:[],zIndex:1}},watch:{photoHtmlItems:{handler(e,t){(t.length>=50||t.length==this.photos.length)&&(t.shift(),this.displayedPhotos.shift())},deep:!0},newPhotos:{handler(e,t){if(this.readyForNewPhoto&&t.length>0){console.log(this.readyForNewPhoto),this.readyForNewPhoto=!1;let e=this;e.displayedNewPhoto=t[0],setTimeout(()=>{console.log("first timeout"),e.displayedNewPhoto=null,setTimeout(()=>{console.log("inner timeout"),e.readyForNewPhoto=!0,e.newPhotos.shift()},2500)},6e3)}},deep:!0}},methods:{connectWebSocket(){let e=this;e.socket=new WebSocket(p["d"]+"/new_photos"),e.socket.onmessage=function(t){let o=JSON.parse(t.data);"add"===o.action?(e.photos.push(o.photo),e.newPhotos.push(o.photo)):"delete"===o.action?e.photos=e.photos.filter(e=>e.filename!=o.photo.filename):console.log('Websocket received unknown action "'+o.action+'".')},e.socket.onclose=function(){e.$store.commit("addNotification",{content:"Verbindung zum Server verloren.",color:"error",showTime:2e3}),console.log("WebSocket connection is closed. Attem,pting reconnect."),setTimeout((function(){e.connectWebSocket()}),1e3)},e.socket.onerror=function(t){console.log("WebSocket encountered error: "+t.message+"Closing Websocket."),e.socket.close()}},addPhoto(){let e=this.photos.filter(e=>!this.displayedPhotos.includes(e.filename)),t=Math.floor(Math.random()*e.length),o=e[t];o.left=Math.floor(Math.random()*this.maxLeft),o.top=Math.floor(Math.random()*this.minTop),o.transform=.5-Math.random()<0?"scale(2.5) rotate(-45deg)":"scale(2.5) rotate(45deg)",o.zIndex=this.zIndex,this.zIndex++,this.photoHtmlItems.push({photo:o}),this.displayedPhotos.push(o.filename),setTimeout(()=>{o.transform="scale(1) rotate("+(10*Math.random()-5)+"deg)",o.class="added"},100)},addEveryXseconds(e){this.addPhoto();let t=this;setTimeout(()=>{t.addEveryXseconds(e)},1e3*e)},calcDimensions(){let e=window.innerWidth,t=window.innerHeight;this.maxLeft=e/3*2,this.minTop=t/2}},mounted(){this.calcDimensions(),r["a"].getAllPhotos(this.$store.state.token).then(e=>{this.photos=e.data}).then(()=>{this.connectWebSocket()}).finally(()=>{this.addEveryXseconds(4)})},beforeUnmount(){this.socket.close()}},u=(o("dfe9"),o("6b0d")),f=o.n(u);const b=f()(m,[["render",l]]);t["default"]=b},dfe9:function(e,t,o){"use strict";o("3734")}}]);
//# sourceMappingURL=Slideshow.0352ef24.js.map